!function(){"use strict";var t={350:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.InputImage=void 0;var n=function(){function t(t){this.hiddenCanvas=document.createElement("canvas"),this.hiddenContext=this.hiddenCanvas.getContext("2d"),this.sourceImage=t,this._size={width:0,height:0},this.resize({width:t.width,height:t.height})}return Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._size.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._size.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceImageAspectRatio",{get:function(){return this.sourceImage.width/this.sourceImage.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(t){var e=Math.min(this.sourceImage.width,t.width),n=t.height;if(this.width!==e||this.height!==n){console.log("Resize image from "+this.width+"x"+this.height+" to "+e+"x"+n+"."),this._size.width=e,this._size.height=n,this.hiddenCanvas.width=this.width,this.hiddenCanvas.height=this.height,this.hiddenContext.drawImage(this.sourceImage,0,0,this.width,this.height);var i=this.hiddenContext.getImageData(0,0,this.width,this.height).data;this.valueArray=new Uint8ClampedArray(this.width*this.height);for(var r=0;r<this.valueArray.length;r++){var a=i[4*r],o=i[4*r+1],s=i[4*r+2];this.valueArray[r]=(a+o+s)/3}}},t.prototype.sample=function(t,e){var n=Math.floor(t),i=Math.floor(e),r=this.getPixel(n,i),a=this.getPixel(n+1,i),o=this.getPixel(n,i+1),s=this.getPixel(n+1,i+1),h=t-n,l=this.interpolate(r,a,h),u=this.interpolate(o,s,h),c=e-i;return this.interpolate(l,u,c)/255},t.prototype.interpolate=function(t,e,n){return t*(1-n)+e*n},t.prototype.getPixel=function(t,e){return t<0||e<0||t>=this.width||e>=this.height?0:this.valueArray[e*this.width+t]},t}();e.InputImage=n},633:function(t,e,n){var i=n(61),r=n(350),a=n(886),o=n(174),s=n(690);n(457);var h=null;function l(t){var e=Date.now();if(null!=h){var n={backgroundColor:i.Parameters.invertColors?"black":"white",lineColor:i.Parameters.invertColors?"white":"black",lineWidth:i.Parameters.lineWidth,blur:i.Parameters.blur};t.initialize(n);var r=new s.PatternStraightLines(h.size,t.size,i.Parameters.linesCount);h.resize(r.wantedImageSize);for(var a=i.Parameters.trueIntensity?i.Parameters.invertColors?function(t){return Math.sqrt(h.sample(t.x,t.y))}:function(t){return Math.sqrt(1.001-h.sample(t.x,t.y))}:i.Parameters.invertColors?function(t){return h.sample(t.x,t.y)}:function(t){return 1-h.sample(t.x,t.y)},o=h.sourceImageAspectRatio,l=t.size,u=function(t,e){var n=t.width/t.height,i=t.width,r=t.height;return e>n?r*=n/e:e<n&&(i*=e/n),{width:Math.floor(i),height:Math.floor(r)}}(t.size,o),c=.5*(l.width-u.width),d=.5*(l.height-u.height),g=u.width/h.width,p=u.height/h.height,f=2*Math.PI*i.Parameters.angle,P=Math.cos(f),v=Math.sin(f),b=500*i.Parameters.maxFrequency/h.width,y=.5*p*i.Parameters.maxAmplitude/P,w=1/(2*b),m=function(e){t.startLine();var n=0;r.walkOnLine(e,w,(function(e,i){var r,o=a(e),s=o*y*Math.sin(n),h=s*(i.x*P-i.y*v),l=s*(i.x*v+i.y*P),u=c+((r=e).x+.5)*g,f=d+(r.y+.5)*p;t.addPointToLine(u+h,f+l),n+=o*b*w})),t.endLine()},x=0;x<r.nbLines;x++)m(x);t.finalize(),console.log("Plotting took "+(Date.now()-e)+" ms.")}else console.log("Image not loaded!")}var u=new a.PlotterCanvas2D;function c(){l(u)}function d(t){u.blur=t}function g(t){h=new r.InputImage(t),Page.Canvas.showLoader(!1),c()}i.Parameters.addRedrawObserver(c),i.Parameters.addBlurChangeObserver(d),d(i.Parameters.blur),i.Parameters.addDownloadObserver((function(){var t=new o.PlotterSVG;l(t);var e="image-as-sines.svg",n="text/plain",i=t.export(),r=new Blob([i],{type:n});if(void 0!==window.navigator&&void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(r,e);else{var a=URL.createObjectURL(r),s=document.createElement("a");s.download=e,s.href=a,s.dataset.downloadurl=n+":"+s.download+":"+s.href,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),setTimeout((function(){URL.revokeObjectURL(a)}),5e3)}})),i.Parameters.addFileUploadObserver(g),Page.Canvas.showLoader(!0);var p=new Image;p.addEventListener("load",(function(){g(p)})),p.src="./resources/cat.jpg"},457:function(){},61:function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.Parameters=void 0,n(457);var i="lines-count-range-id",r="max-amplitude-range-id",a="max-frequency-range-id",o="angle-range-id",s="line-width-range-id",h="invert-colors-checkbox-id",l="blur-range-id",u="true-intensity-checkbox-id",c=[];function d(){for(var t=0,e=c;t<e.length;t++)(0,e[t])()}Page.Range.addLazyObserver(i,d),Page.Range.addLazyObserver(r,d),Page.Range.addLazyObserver(a,d),Page.Range.addLazyObserver(o,d),Page.Range.addLazyObserver(s,d),Page.Checkbox.addObserver(h,d),Page.Checkbox.addObserver(u,d),Page.Canvas.Observers.canvasResize.push(d);var g=function(){function t(){}return t.addFileUploadObserver=function(t){Page.FileControl.addUploadObserver("input-image-upload-button",(function(e){if(1===e.length){Page.Canvas.showLoader(!0);var n=new FileReader;n.onload=function(){var e=new Image;e.addEventListener("load",(function(){t(e)})),e.src=n.result},n.readAsDataURL(e[0])}}))},Object.defineProperty(t,"linesCount",{get:function(){return Page.Range.getValue(i)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxAmplitude",{get:function(){return Page.Range.getValue(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxFrequency",{get:function(){return Page.Range.getValue(a)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"angle",{get:function(){return Page.Range.getValue(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lineWidth",{get:function(){return Page.Range.getValue(s)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invertColors",{get:function(){return Page.Checkbox.isChecked(h)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"trueIntensity",{get:function(){return Page.Checkbox.isChecked(u)},enumerable:!1,configurable:!0}),t.addRedrawObserver=function(t){c.push(t)},Object.defineProperty(t,"blur",{get:function(){return Page.Range.getValue(l)},enumerable:!1,configurable:!0}),t.addBlurChangeObserver=function(t){Page.Range.addObserver(l,t)},t.addDownloadObserver=function(t){Page.FileControl.addDownloadObserver("result-download-id",t)},t}();e.Parameters=g},919:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.PatternBase=void 0;e.PatternBase=function(){}},690:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PatternStraightLines=void 0;var a=function(t){function e(e,n,i){var r=t.call(this)||this;return r._wantedImageSize={width:Math.min(e.width,n.width),height:i},r._nbLines=i,r._startX=0,r._endX=e.width-1,r}return r(e,t),Object.defineProperty(e.prototype,"wantedImageSize",{get:function(){return this._wantedImageSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nbLines",{get:function(){return this._nbLines},enumerable:!1,configurable:!0}),e.prototype.walkOnLine=function(t,e,n){var i={x:0,y:1},r=this._startX,a=this._endX;function o(e){return{x:r*(1-e)+a*e,y:t}}for(var s=a-r,h=s/e,l=0;l<h;l++)n(o(l*e/s),i);n(o(1),i)},e}(n(919).PatternBase);e.PatternStraightLines=a},792:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.PlotterBase=void 0;var n=.01*Math.PI,i=function(){function t(){}return t.prototype.startLine=function(){this.startLineInternal(),this.lastDrawnPoint=null,this.potentialNextPoint=null},t.prototype.addPointToLine=function(e,i){var r={x:e,y:i};null===this.lastDrawnPoint?(this.lastDrawnPoint=r,this.addFirstPointToLineInternal(this.lastDrawnPoint.x,this.lastDrawnPoint.y)):(null===this.potentialNextPoint||t.computeAngle(this.lastDrawnPoint,this.potentialNextPoint,r)>n&&(this.addPointToLineInternal(this.potentialNextPoint.x,this.potentialNextPoint.y),this.lastDrawnPoint=this.potentialNextPoint),this.potentialNextPoint=r)},t.prototype.endLine=function(){null!==this.potentialNextPoint&&this.addPointToLineInternal(this.potentialNextPoint.x,this.potentialNextPoint.y),this.lastDrawnPoint=null,this.potentialNextPoint=null,this.endLineInternal()},t.computeAngle=function(t,e,n){var i=Math.atan2(e.y-t.y,e.x-t.x),r=Math.atan2(n.y-e.y,n.x-e.x),a=Math.abs(i-r);return Math.min(a,2*Math.PI-a)},t}();e.PlotterBase=i},886:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PlotterCanvas2D=void 0;var a=n(792);n(457);var o=function(t){function e(){var e,n=t.call(this)||this;return n.canvas=Page.Canvas.getCanvas(),n.context=n.canvas.getContext("2d",{alpha:!1}),n.cssPixel=null!==(e=window.devicePixelRatio)&&void 0!==e?e:1,n}return r(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return{width:Math.floor(this.canvas.width/this.cssPixel),height:Math.floor(this.canvas.height/this.cssPixel)}},enumerable:!1,configurable:!0}),e.prototype.initialize=function(t){this.resizeCanvas(),this.context.fillStyle=t.backgroundColor,this.context.strokeStyle=t.lineColor,this.context.lineWidth=t.lineWidth*this.cssPixel,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.finalize=function(){},Object.defineProperty(e.prototype,"blur",{set:function(t){this.canvas.style.filter=0===t?"":"blur("+t+"px)"},enumerable:!1,configurable:!0}),e.prototype.startLineInternal=function(){this.context.beginPath()},e.prototype.addFirstPointToLineInternal=function(t,e){var n=t*this.cssPixel,i=e*this.cssPixel;this.context.moveTo(n,i)},e.prototype.addPointToLineInternal=function(t,e){var n=t*this.cssPixel,i=e*this.cssPixel;this.context.lineTo(n,i)},e.prototype.endLineInternal=function(){this.context.stroke(),this.context.closePath()},e.prototype.resizeCanvas=function(){var t=Math.floor(this.cssPixel*this.canvas.clientWidth),e=Math.floor(this.cssPixel*this.canvas.clientHeight);this.canvas.width===t&&this.canvas.height===e||(this.canvas.width=t,this.canvas.height=e)},e}(a.PlotterBase);e.PlotterCanvas2D=o},174:function(t,e,n){var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.PlotterSVG=void 0;var a=n(792),o=function(t){function e(){return t.call(this)||this}return r(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return{width:1e3,height:1e3}},enumerable:!1,configurable:!0}),e.prototype.initialize=function(t){this.hasBlur=t.blur>0,this.stringParts=[],this.stringParts.push('<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n'),this.stringParts.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1000 1000">\n'),this.hasBlur&&(this.stringParts.push("\t<defs>\n"),this.stringParts.push('\t\t<filter id="gaussianBlur" x="0" y="0">\n'),this.stringParts.push('\t\t\t<feGaussianBlur in="SourceGraphic" stdDeviation="'+t.blur+'"/>\n'),this.stringParts.push("\t\t</filter>\n"),this.stringParts.push("\t</defs>\n"),this.stringParts.push('\t<g filter="url(#gaussianBlur)">\n')),this.stringParts.push('\t<path fill="'+t.backgroundColor+'" stroke="none" d="M0,0H1000V1000H0Z"/>\n'),this.stringParts.push('\t<g fill="none" stroke="'+t.lineColor+'" stroke-width="'+t.lineWidth+'" stroke-linejoin="round">\n')},e.prototype.finalize=function(){this.hasBlur&&this.stringParts.push("\t\t</g>\n"),this.stringParts.push("\t</g>\n"),this.stringParts.push("</svg>\n")},e.prototype.endLineInternal=function(){this.stringParts.push('"/>\n')},e.prototype.export=function(){var t=Date.now(),e=this.stringParts.join("");return console.log("Concatenation took "+(Date.now()-t)+" ms."),e},e.prototype.startLineInternal=function(){this.stringParts.push('\t\t<path d="')},e.prototype.addFirstPointToLineInternal=function(t,e){var n=t.toFixed(1),i=e.toFixed(1);this.stringParts.push("M"+n+","+i+"L")},e.prototype.addPointToLineInternal=function(t,e){var n=t.toFixed(1),i=e.toFixed(1);this.stringParts.push(n+","+i+" ")},e}(a.PlotterBase);e.PlotterSVG=o}},e={};!function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}(633)}();
//# sourceMappingURL=main.min.js.map