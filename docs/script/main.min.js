!function(){"use strict";var e={747:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.downloadTextFile=t.choosePattern=t.chooseLines=void 0;var i=n(61),r=n(393),o=n(748),a=n(833),s=n(213),u=n(827),c=n(726);t.chooseLines=function(e,t){var n=i.Parameters.linesType;return n===i.ELinesType.STRAIGHT?new r.LinesStraightLines(e,t):n===i.ELinesType.SPIRAL?new a.LinesSpiral(e,t):n===i.ELinesType.POLYGON?new s.LinesPolygon(e,t):new o.LinesSines(e,t)},t.choosePattern=function(e,t){return i.Parameters.pattern===i.EPattern.WAVES?new u.PatternWave(e,t):new c.PatternDithering(e,t)},t.downloadTextFile=function(e,t){var n="text/plain",i=new Blob([e],{type:n});if(void 0!==window.navigator&&void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(i,t);else{var r=URL.createObjectURL(i),o=document.createElement("a");o.download=t,o.href=r,o.dataset.downloadurl="".concat(n,":").concat(o.download,":").concat(o.href),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout((function(){URL.revokeObjectURL(r)}),5e3)}}},350:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.InputImage=void 0;var n=function(){function e(e){this.hiddenCanvas=document.createElement("canvas"),this.hiddenContext=this.hiddenCanvas.getContext("2d",{willReadFrequently:!0}),this.sourceImage=e,this._size={width:0,height:0},this.resize({width:e.width,height:e.height})}return Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._size.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._size.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sourceImageAspectRatio",{get:function(){return this.sourceImage.width/this.sourceImage.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(e){var t=Math.min(this.sourceImage.width,e.width),n=Math.min(this.sourceImage.height,e.height);if(this.width!==t||this.height!==n){console.log("Resize image from ".concat(this.width,"x").concat(this.height," to ").concat(t,"x").concat(n,".")),this._size.width=t,this._size.height=n,this.hiddenCanvas.width=this.width,this.hiddenCanvas.height=this.height,this.hiddenContext.drawImage(this.sourceImage,0,0,this.width,this.height);var i=this.hiddenContext.getImageData(0,0,this.width,this.height).data;this.valueArray=new Uint8ClampedArray(this.width*this.height);for(var r=0;r<this.valueArray.length;r++){var o=i[4*r],a=i[4*r+1],s=i[4*r+2];this.valueArray[r]=(o+a+s)/3}}},e.prototype.sample=function(e){var t={x:e.x*(this._size.width-1),y:e.y*(this._size.height-1)},n={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-n.x,y:t.y-n.y},r=this.getPixel(n.x,n.y),o=this.getPixel(n.x+1,n.y),a=this.getPixel(n.x,n.y+1),s=this.getPixel(n.x+1,n.y+1),u=this.interpolate(r,o,i.x),c=this.interpolate(a,s,i.x);return this.interpolate(u,c,i.y)/255},e.prototype.interpolate=function(e,t,n){return e*(1-n)+t*n},e.prototype.getPixel=function(e,t){return e<0||t<0||e>=this.width||t>=this.height?0:this.valueArray[t*this.width+e]},e}();t.InputImage=n},31:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.rotate=t.distance=void 0,t.distance=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},t.rotate=function(e,t){var n=Math.cos(t),i=Math.sin(t);return{x:e.x*n-e.y*i,y:e.x*i+e.y*n}}},553:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LinesBase=void 0;t.LinesBase=function(){}},213:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinesPolygon=void 0;var o=n(31),a=n(61),s=function(e){function t(t,n){var i=e.call(this)||this;i._center={x:.5*t.width,y:.5*t.height},i._suggestedImageSize={width:t.width,height:t.height},i._linesSpacing=n,i._nbSides=a.Parameters.linesSides;var r=Math.sqrt(t.width*t.width+t.height*t.height);return i._maxSegments=Math.ceil(i._nbSides*r/n),i}return r(t,e),Object.defineProperty(t.prototype,"suggestedImageSize",{get:function(){return this._suggestedImageSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nbLines",{get:function(){return 1},enumerable:!1,configurable:!0}),t.prototype.walkOnLine=function(e,t,n){for(var i=Math.PI*(this._nbSides-2)/this._nbSides,r=2*this._linesSpacing/Math.tan(i/2)/this._nbSides,s=.5*r,u=a.Parameters.orientationInRadians,c=Math.cos(u),l=Math.sin(u),h={x:this._center.x,y:this._center.y},d=0;d<this._maxSegments;d++){for(var g=s+d*r,p=Math.PI+d%this._nbSides*2*Math.PI/this._nbSides,f={x:h.x+g*Math.cos(p),y:h.y+g*Math.sin(p)},y=p+u+Math.PI/2,P={x:Math.cos(y),y:Math.sin(y)},v=(0,o.distance)(h,f),b=0;b*t<v;b++){var m=b*t/v,_=h.x*(1-m)+f.x*m-this._center.x,x=h.y*(1-m)+f.y*m-this._center.y;n({x:c*_-l*x+this._center.x,y:l*_+c*x+this._center.y},P)}h=f}},t}(n(553).LinesBase);t.LinesPolygon=s},748:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinesSines=void 0;var o=n(553),a=n(61),s=function(e){function t(n,i){var r=e.call(this)||this;r._frequency=a.Parameters.linesFrequency,r._amplitude=.2*a.Parameters.linesAmplitude*Math.max(n.width,n.height),r._normal={x:-Math.sin(a.Parameters.orientationInRadians),y:Math.cos(a.Parameters.orientationInRadians)},r._lines=[],r._lines.push(t.computeLine(0,i,r._normal,n));for(var o=r.computeMaximumLinesNeeded(n,i)/2+1,s=1;s<o;s++)for(var u=-1;u<=2;u+=2){var c=s*u,l=t.computeLine(c,i,r._normal,n);r._lines.push(l)}return r._suggestedImageSize={width:n.width,height:n.height},r}return r(t,e),Object.defineProperty(t.prototype,"suggestedImageSize",{get:function(){return this._suggestedImageSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nbLines",{get:function(){return this._lines.length},enumerable:!1,configurable:!0}),t.prototype.walkOnLine=function(e,t,n){for(var i=this,r=this._lines[e],o=function(e){var t=i._amplitude*Math.sin(2*Math.PI*e*i._frequency);return{x:r.start.x*(1-e)+r.end.x*e+t*i._normal.x,y:r.start.y*(1-e)+r.end.y*e+t*i._normal.y}},a=r.length/t,s=0;s<a;s++)n(o(s*t/r.length),this._normal);n(o(1),this._normal)},t.computeLine=function(e,t,n,i){var r=Math.sqrt(i.width*i.width+i.height*i.height),o=n.y,a=-n.x,s=.5*i.width+e*t*n.x,u=.5*i.height+e*t*n.y;return{start:{x:s-.5*r*o,y:u-.5*r*a},end:{x:s+.5*r*o,y:u+.5*r*a},length:r}},t.prototype.computeMaximumLinesNeeded=function(e,t){var n=e.width+2*this._amplitude,i=e.height+2*this._amplitude,r=Math.sqrt(n*n+i*i);return Math.ceil(r/t)},t}(o.LinesBase);t.LinesSines=s},833:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinesSpiral=void 0;var o=n(61),a=function(e){function t(t,n){var i=e.call(this)||this;i._center={x:.5*t.width,y:.5*t.height},i._suggestedImageSize={width:t.width,height:t.height},i._radiusGap=.5*n;var r=Math.sqrt(t.width*t.width+t.height*t.height),o=Math.ceil(r/n);return i._maxAngle=o*Math.PI,i}return r(t,e),Object.defineProperty(t.prototype,"suggestedImageSize",{get:function(){return this._suggestedImageSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nbLines",{get:function(){return 1},enumerable:!1,configurable:!0}),t.prototype.walkOnLine=function(e,t,n){for(var i=o.Parameters.orientationInRadians,r=Math.cos(i),a=Math.sin(i),s=0;s<this._maxAngle;){var u=Math.cos(s),c=Math.sin(s),l=Math.ceil((s-i)/Math.PI),h=(l+.125)*this._radiusGap,d=this._radiusGap*(.5-l%2);n({x:this._center.x+d*r+h*u,y:this._center.y+d*a+h*c},{x:-u,y:-c}),s+=t/h}},t}(n(553).LinesBase);t.LinesSpiral=a},393:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinesStraightLines=void 0;var o,a=n(31),s=n(553),u=n(61);!function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL",e[e.DIAGONAL=2]="DIAGONAL"}(o||(o={}));var c=function(e){function t(n,i){var r=e.call(this)||this;r._normal={x:-Math.sin(u.Parameters.orientationInRadians),y:Math.cos(u.Parameters.orientationInRadians)};var a=o.DIAGONAL;u.Parameters.orientationInDegrees%180==90?a=o.VERTICAL:u.Parameters.orientationInDegrees%180==0&&(a=o.HORIZONTAL),r._lines=[],r._lines.push(t.computeLine(0,i,a,r._normal,n));for(var s=t.computeMaximumLinesNeeded(n,i)/2+1,c=1;c<s;c++)for(var l=-1;l<=2;l+=2){var h=c*l,d=t.computeLine(h,i,a,r._normal,n),g=d.start.x<-.1||d.start.x>n.width-1+.1,p=d.start.y<-.1||d.start.y>n.height-1+.1;if(g||p)break;r._lines.push(d)}return r._suggestedImageSize=t.computeBestImageSize(n,r._lines.length,a),r}return r(t,e),Object.defineProperty(t.prototype,"suggestedImageSize",{get:function(){return this._suggestedImageSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nbLines",{get:function(){return this._lines.length},enumerable:!1,configurable:!0}),t.prototype.walkOnLine=function(e,t,n){var i=this._lines[e];function r(e){return{x:i.start.x*(1-e)+i.end.x*e,y:i.start.y*(1-e)+i.end.y*e}}for(var o=i.length/t,a=0;a<o;a++)n(r(a*t/i.length),this._normal);n(r(1),this._normal)},t.computeLine=function(e,t,n,i,r){var s=i.y,u=-i.x,c={x:.5*r.width+e*t*i.x,y:.5*r.height+e*t*i.y},l={x:c.x,y:c.y},h=r.width-1,d=r.height-1;if(n===o.HORIZONTAL)c.x=0,l.x=h;else if(n===o.VERTICAL)c.y=0,l.y=d;else{var g=Math.min(c.x/s,c.y/u);c.x-=g*s,c.y-=g*u;var p=Math.min((h-l.x)/s,(d-l.y)/u);l.x+=p*s,l.y+=p*u}return{start:c,end:l,length:(0,a.distance)(c,l)}},t.computeBestImageSize=function(e,t,n){return n===o.HORIZONTAL?{width:e.width,height:t}:n===o.VERTICAL?{width:t,height:e.height}:{width:e.width,height:e.height}},t.computeMaximumLinesNeeded=function(e,t){var n=Math.sqrt(e.width*e.width+e.height*e.height);return Math.ceil(n/t)},t}(s.LinesBase);t.LinesStraightLines=c},633:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(61),s=n(350),u=n(886),c=n(174),l=o(n(747));function h(e,t){var n=performance.now();if(null!=e){t.resize();var i=t.fitImage(e.sourceImageAspectRatio),r=1/a.Parameters.linesCount*i.zoomFactor,o=l.chooseLines(i.sizeInPlotter,r),s=l.choosePattern(i,r);e.resize(o.suggestedImageSize);var u=s.buildPlotterInfos();t.initialize(u);for(var c=0;c<o.nbLines;c++)s.drawLine(o,c,e,t);t.finalize(),console.log("Plotting took ".concat(performance.now()-n," ms."))}else console.log("Image not loaded!")}n(457);var d=null,g=new u.PlotterCanvas2D;function p(){h(d,g)}function f(e){g.blur=e}function y(e){d=new s.InputImage(e),Page.Canvas.showLoader(!1),p()}a.Parameters.addRedrawObserver(p),a.Parameters.addBlurChangeObserver(f),f(a.Parameters.blur),a.Parameters.addDownloadObserver((function(){var e=new c.PlotterSVG;h(d,e);var t=e.export();l.downloadTextFile(t,"image-as-sines.svg")})),a.Parameters.addFileUploadObserver(y),Page.Canvas.showLoader(!0);var P=new Image;P.addEventListener("load",(function(){y(P)})),P.src="./resources/cat.jpg"},457:function(){},61:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.EPattern=t.ELinesType=t.Parameters=void 0,n(457);var i,r,o={UPLOAD_INPUT_IMAGE:"input-image-upload-button",LINES_TYPE:"lines-type-tabs-id",LINES_COUNT:"lines-count-range-id",ORIENTATION:"orientation-range-id",LINES_SIDES:"lines-sides-range-id",LINES_AMPLITUDE:"lines-amplitude-range-id",LINES_FREQUENCY:"lines-frequency-range-id",PATTERN:"pattern-tabs-id",AMPLITUDE:"max-amplitude-range-id",FREQUENCY:"max-frequency-range-id",ANGLE:"angle-range-id",WAVE_SQUARENESS:"wave-squareness-range-id",LINE_THICKNESS:"line-thickness-range-id",INVERT_COLORS:"invert-colors-checkbox-id",BLUR:"blur-range-id",DOWNLOAD:"result-download-id"};!function(e){e.STRAIGHT="0",e.SPIRAL="1",e.POLYGON="2",e.SINES="3"}(i||(i={})),t.ELinesType=i,function(e){e.WAVES="0",e.DITHERING="1"}(r||(r={})),t.EPattern=r;var a=[];function s(){for(var e=0,t=a;e<t.length;e++)(0,t[e])()}Page.Tabs.addObserver(o.LINES_TYPE,s),Page.Range.addLazyObserver(o.LINES_COUNT,s),Page.Range.addLazyObserver(o.ORIENTATION,s),Page.Range.addLazyObserver(o.LINES_SIDES,s),Page.Range.addLazyObserver(o.LINES_AMPLITUDE,s),Page.Range.addLazyObserver(o.LINES_FREQUENCY,s),Page.Tabs.addObserver(o.PATTERN,s),Page.Range.addLazyObserver(o.AMPLITUDE,s),Page.Range.addLazyObserver(o.FREQUENCY,s),Page.Range.addLazyObserver(o.ANGLE,s),Page.Range.addLazyObserver(o.WAVE_SQUARENESS,s),Page.Range.addLazyObserver(o.LINE_THICKNESS,s),Page.Checkbox.addObserver(o.INVERT_COLORS,s),Page.Canvas.Observers.canvasResize.push(s);var u=function(){function e(){}return e.addFileUploadObserver=function(e){Page.FileControl.addUploadObserver(o.UPLOAD_INPUT_IMAGE,(function(t){if(1===t.length){Page.Canvas.showLoader(!0);var n=new FileReader;n.onload=function(){var t=new Image;t.addEventListener("load",(function(){e(t)})),t.src=n.result},n.readAsDataURL(t[0])}}))},Object.defineProperty(e,"linesType",{get:function(){return Page.Tabs.getValues(o.LINES_TYPE)[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linesCount",{get:function(){return Page.Range.getValue(o.LINES_COUNT)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"orientationInDegrees",{get:function(){return Page.Range.getValue(o.ORIENTATION)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"orientationInRadians",{get:function(){return this.orientationInDegrees/180*Math.PI},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linesSides",{get:function(){return Page.Range.getValue(o.LINES_SIDES)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linesAmplitude",{get:function(){return Page.Range.getValue(o.LINES_AMPLITUDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"linesFrequency",{get:function(){return Page.Range.getValue(o.LINES_FREQUENCY)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pattern",{get:function(){return Page.Tabs.getValues(o.PATTERN)[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxAmplitude",{get:function(){return Page.Range.getValue(o.AMPLITUDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"maxFrequency",{get:function(){return Page.Range.getValue(o.FREQUENCY)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"angle",{get:function(){return Page.Range.getValue(o.ANGLE)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"waveSquareness",{get:function(){return Page.Range.getValue(o.WAVE_SQUARENESS)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"lineThickness",{get:function(){return Page.Range.getValue(o.LINE_THICKNESS)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"invertColors",{get:function(){return Page.Checkbox.isChecked(o.INVERT_COLORS)},enumerable:!1,configurable:!0}),e.addRedrawObserver=function(e){a.push(e)},Object.defineProperty(e,"blur",{get:function(){return Page.Range.getValue(o.BLUR)},enumerable:!1,configurable:!0}),e.addBlurChangeObserver=function(e){Page.Range.addObserver(o.BLUR,e)},e.addDownloadObserver=function(e){Page.FileControl.addDownloadObserver(o.DOWNLOAD,e)},e}();function c(){Page.Controls.setVisibility(o.PATTERN,!1);var e=u.linesType;Page.Controls.setVisibility(o.LINES_SIDES,e===i.POLYGON),Page.Controls.setVisibility(o.LINES_AMPLITUDE,e===i.SINES),Page.Controls.setVisibility(o.LINES_FREQUENCY,e===i.SINES);var t=u.pattern;Page.Controls.setVisibility(o.ANGLE,t===r.WAVES),Page.Controls.setVisibility(o.WAVE_SQUARENESS,t===r.WAVES),Page.Controls.setVisibility(o.LINE_THICKNESS,t===r.WAVES)}t.Parameters=u,Page.Tabs.addObserver(o.LINES_TYPE,c),Page.Tabs.addObserver(o.PATTERN,c),c();var l=null,h=null;Page.Tabs.addObserver(o.PATTERN,(function(){var e=u.pattern,t=Page.Range.getValue(o.AMPLITUDE),n=Page.Range.getValue(o.FREQUENCY),i=l,a=h;e===r.WAVES?(i=null===i?1:i,a=null===a?.4:a):e===r.DITHERING&&(i=null===i?.5:i,a=null===a?.5:a),Page.Range.setValue(o.AMPLITUDE,i),Page.Range.setValue(o.FREQUENCY,a),l=t,h=n,s()}))},919:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PatternBase=void 0;t.PatternBase=function(){}},726:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PatternDithering=void 0;var o=n(61),a=n(919),s=[],u=function(e){function t(n,i){var r=e.call(this)||this;r.samplingFunction=t.chooseBestSamplingFunction(),r.imageFitting=n,r.linesThickness=Math.max(1,o.Parameters.maxAmplitude*i);var a=o.Parameters.maxFrequency,s=10*(1-a)+1e3*a;r.samplesPerPortion=Math.ceil(1e3/s);var u=s*r.samplesPerPortion/n.zoomFactor;return r.step=1/u,r}return r(t,e),t.prototype.buildPlotterInfos=function(){return{backgroundColor:o.Parameters.invertColors?"black":"white",lineColor:o.Parameters.invertColors?"white":"black",lineThickness:this.linesThickness,roundLinecap:!1,blur:o.Parameters.blur}},t.prototype.drawLine=function(e,n,i,r){var o=this;void 0===s[n]&&(s[n]=Math.round(1e3*Math.random()));var a=s[n],u=0,c=!1;e.walkOnLine(n,this.step,(function(e){var n,s=o.imageFitting.pixelToRelative(e);if(s.x<0||s.x>1||s.y<0||s.y>1)r.hasStartedALine&&r.endLine(),c=!1;else{if(u%o.samplesPerPortion<.1){var l=(0,1,(n=o.samplingFunction(i,s))<0?0:n>1?1:n),h=Math.floor(.99*l*t.ditheringPatterns.length),d=t.ditheringPatterns[h],g=Math.floor(u/o.samplesPerPortion)+a;c=d[Math.floor(g%d.length)]>.5}if(c){r.hasStartedALine||r.startLine();var p=o.imageFitting.relativeToAbsolute(e);r.addPointToLine(p.x,p.y)}else r.hasStartedALine&&(p=o.imageFitting.relativeToAbsolute(e),r.addPointToLine(p.x,p.y),r.endLine());u++}})),r.hasStartedALine&&r.endLine()},t.chooseBestSamplingFunction=function(){return o.Parameters.invertColors?function(e,t){return e.sample(t)}:function(e,t){return 1-e.sample(t)}},t.ditheringPatterns=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0],[0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0],[0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0],[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0],[1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0],[1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,0],[1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0],[1,0,1,0,1,1,0,1,1,0,1,0,1,0,1,0],[1,0,1,1,0,1,0,1,1,0,1,1,0,1,1,0],[1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1],[1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],[1,1,1,0,1,1,1,1,0,1,1,1,1,0,1,1],[1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],t}(a.PatternBase);t.PatternDithering=u},827:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PatternWave=void 0;var o=n(61),a=function(e){function t(n,i){var r=e.call(this)||this;r.waveFunction=t.computeWaveFunction(),r.normalRotationFunction=t.computeNormalRotationFunction(),r.samplingFunction=t.chooseBestSamplingFunction(),r.imageFitting=n;var a=2500*o.Parameters.maxFrequency;r.maxFrequency=a/n.zoomFactor,r.maxAmplitude=.5*(i-o.Parameters.lineThickness)*o.Parameters.maxAmplitude;var s=Math.max(1,2*r.maxFrequency);return r.step=1/s,r}return r(t,e),t.prototype.buildPlotterInfos=function(){return{backgroundColor:o.Parameters.invertColors?"black":"white",lineColor:o.Parameters.invertColors?"white":"black",lineThickness:o.Parameters.lineThickness,roundLinecap:!0,blur:o.Parameters.blur}},t.prototype.drawLine=function(e,t,n,i){var r=this,o=0;e.walkOnLine(t,this.step,(function(e,t){var a=r.imageFitting.pixelToRelative(e);if(a.x<0||a.x>1||a.y<0||a.y>1)i.hasStartedALine&&i.endLine();else{var s=r.samplingFunction(n,a),u=s*r.maxAmplitude,c=r.waveFunction(o,u),l=r.normalRotationFunction(t),h=c*l.x,d=c*l.y,g=r.imageFitting.relativeToAbsolute(e);i.hasStartedALine||i.startLine(),i.addPointToLine(g.x+h,g.y+d);var p=s*r.maxFrequency;o+=p*r.step}})),i.hasStartedALine&&i.endLine()},t.computeNormalRotationFunction=function(){var e=2*o.Parameters.angle*Math.PI,t=Math.cos(e),n=Math.sin(e),i=1/t;return function(e){return{x:(t*e.x-n*e.y)*i,y:(n*e.x+t*e.y)*i}}},t.computeWaveFunction=function(){if(o.Parameters.waveSquareness<.005)return function(e,t){return t*Math.sin(e)};var e=1-.99*o.Parameters.waveSquareness;return function(t,n){var i=Math.sin(t);return n*Math.sign(i)*Math.pow(Math.abs(i),e)}},t.chooseBestSamplingFunction=function(){return o.Parameters.invertColors?function(e,t){return Math.sqrt(e.sample(t))}:function(e,t){return Math.sqrt(1.001-e.sample(t))}},t}(n(919).PatternBase);t.PatternWave=a},792:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterBase=void 0;var n=.003*Math.PI,i=function(){function e(){this._hasStartedALine=!1}return Object.defineProperty(e.prototype,"hasStartedALine",{get:function(){return this._hasStartedALine},enumerable:!1,configurable:!0}),e.prototype.startLine=function(){this._hasStartedALine=!0,this.startLineInternal(),this.lastDrawnPoint=null,this.potentialNextPoint=null},e.prototype.addPointToLine=function(t,i){var r={x:t,y:i};null===this.lastDrawnPoint?(this.lastDrawnPoint=r,this.addFirstPointToLineInternal(this.lastDrawnPoint.x,this.lastDrawnPoint.y)):(null===this.potentialNextPoint||e.computeAngle(this.lastDrawnPoint,this.potentialNextPoint,r)>n&&(this.addPointToLineInternal(this.potentialNextPoint.x,this.potentialNextPoint.y),this.lastDrawnPoint=this.potentialNextPoint),this.potentialNextPoint=r)},e.prototype.endLine=function(){null!==this.potentialNextPoint&&this.addPointToLineInternal(this.potentialNextPoint.x,this.potentialNextPoint.y),this.lastDrawnPoint=null,this.potentialNextPoint=null,this.endLineInternal(),this._hasStartedALine=!1},e.prototype.fitImage=function(e){var t=this.size,n=t.width/t.height,i={width:t.width,height:t.height};e>n?i.height=Math.floor(i.height*n/e):e<n&&(i.width=Math.floor(i.width*e/n));var r=.5*(t.width-i.width),o=.5*(t.height-i.height),a=Math.min(i.width,i.height),s=Math.min(e,1/e);return{sizeInPlotter:i,relativeToAbsolute:function(e){return{x:e.x+r,y:e.y+o}},pixelToRelative:function(e){return{x:e.x/(i.width-1),y:e.y/(i.height-1)}},zoomFactor:a/s}},e.computeAngle=function(e,t,n){var i=Math.atan2(t.y-e.y,t.x-e.x),r=Math.atan2(n.y-t.y,n.x-t.x),o=Math.abs(i-r);return Math.min(o,2*Math.PI-o)},e}();t.PlotterBase=i},886:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterCanvas2D=void 0;var o=n(792);n(457);var a=function(e){function t(){var t,n=this;return(n=e.call(this)||this).canvas=Page.Canvas.getCanvas(),n.context=n.canvas.getContext("2d",{alpha:!1}),n.cssPixel=null!==(t=window.devicePixelRatio)&&void 0!==t?t:1,n}return r(t,e),t.prototype.resize=function(){var e=Math.floor(this.cssPixel*this.canvas.clientWidth),t=Math.floor(this.cssPixel*this.canvas.clientHeight);this.canvas.width===e&&this.canvas.height===t||(this.canvas.width=e,this.canvas.height=t)},t.prototype.initialize=function(e){this.context.fillStyle=e.backgroundColor,this.context.strokeStyle=e.lineColor,this.context.lineWidth=e.lineThickness*this.cssPixel,this.context.lineJoin="round",this.context.lineCap=e.roundLinecap?"round":"butt",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.finalize=function(){},Object.defineProperty(t.prototype,"blur",{set:function(e){this.canvas.style.filter=0===e?"":"blur(".concat(e,"px)")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return{width:Math.floor(this.canvas.width/this.cssPixel),height:Math.floor(this.canvas.height/this.cssPixel)}},enumerable:!1,configurable:!0}),t.prototype.startLineInternal=function(){this.context.beginPath()},t.prototype.addFirstPointToLineInternal=function(e,t){var n=e*this.cssPixel,i=t*this.cssPixel;this.context.moveTo(n,i)},t.prototype.addPointToLineInternal=function(e,t){var n=e*this.cssPixel,i=t*this.cssPixel;this.context.lineTo(n,i)},t.prototype.endLineInternal=function(){this.context.stroke(),this.context.closePath()},t}(o.PlotterBase);t.PlotterCanvas2D=a},174:function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlotterSVG=void 0;var o=n(792),a=1e3,s=1e3,u=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.resize=function(){},t.prototype.initialize=function(e){if(this.hasBlur=e.blur>0,this.stringParts=[],this.stringParts.push('<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n'),this.stringParts.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '.concat(a," ").concat(s,'">\n')),this.hasBlur){var t="gaussianBlur";this.stringParts.push("\t<defs>\n"),this.stringParts.push('\t\t<filter id="'.concat(t,'" x="0" y="0">\n')),this.stringParts.push('\t\t\t<feGaussianBlur in="SourceGraphic" stdDeviation="'.concat(e.blur,'"/>\n')),this.stringParts.push("\t\t</filter>\n"),this.stringParts.push("\t</defs>\n"),this.stringParts.push('\t<g filter="url(#'.concat(t,')">\n'))}this.stringParts.push('\t<rect fill="'.concat(e.backgroundColor,'" stroke="none" x="0" y="0" width="').concat(a,'" height="').concat(s,'"/>\n'));var n=e.roundLinecap?' stroke-linecap="round"':"";this.stringParts.push('\t<g fill="none" stroke="'.concat(e.lineColor,'" stroke-width="').concat(e.lineThickness,'" stroke-linejoin="round"').concat(n,">\n"))},t.prototype.finalize=function(){this.hasBlur&&this.stringParts.push("\t\t</g>\n"),this.stringParts.push("\t</g>\n"),this.stringParts.push("</svg>\n")},t.prototype.endLineInternal=function(){this.stringParts.push('"/>\n')},t.prototype.export=function(){var e=Date.now(),t=this.stringParts.join("");return console.log("Concatenation took ".concat(Date.now()-e," ms.")),t},Object.defineProperty(t.prototype,"size",{get:function(){return{width:a,height:s}},enumerable:!1,configurable:!0}),t.prototype.startLineInternal=function(){this.stringParts.push('\t\t<path d="')},t.prototype.addFirstPointToLineInternal=function(e,t){var n=e.toFixed(1),i=t.toFixed(1);this.stringParts.push("M".concat(n,",").concat(i,"L"))},t.prototype.addPointToLineInternal=function(e,t){var n=e.toFixed(1),i=t.toFixed(1);this.stringParts.push("".concat(n,",").concat(i," "))},t}(o.PlotterBase);t.PlotterSVG=u}},t={};!function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(633)}();
//# sourceMappingURL=main.min.js.map